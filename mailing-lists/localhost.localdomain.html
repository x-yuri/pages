<!doctype html><html><head><link rel="stylesheet" type="text/css" href="mailing-list.css"></head><body><table class="conversation"><tr id="id_0"><td class="user">Pierre Machard<br><span class="timestamp">2005/09/24 17:35:08</span><td class="message"><p>&#8220;localdomain&#8221; is not a registered top-level domain and hopefully never will be, so it is safe to use locally as it won&#8217;t cause communication problems.</p><tr id="id_1"><td class="user">Bernd Eckenfels<br><span class="timestamp">2005/09/24 18:33:25</span><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant">&#8220;localdomain&#8221; is not a registered top-level domain and hopefully never will be, so it is safe to use locally as it won&#8217;t cause communication problems.</p>
</blockquote><p>It is not safe to use unregistered domains. and I dont see a reason for .localdmain at all.</p><tr id="id_2"><td class="user">Pierre Machard<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00194.html">2005/10/06 07:10:56</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Bernd Eckenfels</p>
<p class="with-author non-relevant">It is not safe to use unregistered domains. and I dont see a reason for .localdmain at all.</p>
</blockquote><p class="non-relevant"><span class="caps">IIRC</span> The main reason was described in <a href="http://tinyurl.com/2an2ujy">#247734</a></p><tr id="id_3"><td class="user">Klaus Ethgen<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00198.html">2005/10/06 07:52:04</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant"><span class="caps">IIRC</span> The main reason was described in <a href="http://tinyurl.com/2an2ujy">#247734</a></p>
</blockquote><p class="non-relevant">The only reason I find is that RedHat use it. But RedHat shouldn&#8217;t be debians requirement of quality. It should be other way around. RedHat is such a buggy distribution. And it gets more and more worse every upgrade.</p><p class="non-relevant">.localdomain is such a peace of shit which only makes troubles. So please hold the high quality of debian and do not polute it with such grab.</p><tr id="id_4"><td class="user">Marco d&#39;Itri<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00234.html">2005/10/06 10:37:47</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Klaus Ethgen</p>
<p class="with-author non-relevant">.localdomain is such a peace of shit which only makes troubles. So</p>
</blockquote><p class="non-relevant">Please explain which troubles.</p><tr id="id_5"><td class="user">Klaus Ethgen<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00202.html">2005/10/06 11:43:29</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Marco d&#8217;Itri</p>
<p class="with-author non-relevant">Please explain which troubles.</p>
</blockquote><p class="non-relevant">I cannot specify it. But I remember that I did search for problemes in the past long time to find a error. And it was an entry of localhost.localdomain in a /etc/hosts. Maybe it was <span class="caps">PVM</span> or MySQL or other. I&#8217;m not sure.</p><p class="non-relevant">If you think for localhost you will never anticipate that it is called localhost.localdomain on one system. The Phrase &#8220;localhost&#8221; is for historical reasons such often used in scripts and programms. It whould create many manyears of troubleshooting putting this .localdomain on the end.</p><tr id="id_6"><td class="user">Marco d&#39;Itri<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00203.html">2005/10/06 11:48:50</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Klaus Ethgen</p>
<p class="with-author non-relevant">I cannot specify it. But I remember that I did search for problemes in</p>
</blockquote><p class="non-relevant">In other words, you don&#8217;t know and are just handwaving. Next?</p><tr id="id_7"><td class="user">Klaus Ethgen<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00205.html">2005/10/06 12:04:44</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Marco d&#8217;Itri</p>
<p class="with-author non-relevant">In other words, you don&#8217;t know and are just handwaving. Next?</p>
</blockquote><p class="non-relevant">No, I just do not remember which software it was. I absolutely remember <span class="caps">THAT</span> it was a problem with localhost.localdomain and <span class="caps">THAT</span> it takes me long time to debug.</p><tr id="id_8"><td class="user">Marco d&#39;Itri<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00206.html">2005/10/06 12:19:01</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Klaus Ethgen</p>
<p class="with-author non-relevant">No, I just do not remember which software it was. I absolutely remember <span class="caps">THAT</span> it was a problem with localhost.localdomain and <span class="caps">THAT</span> it takes me long time to debug.</p>
</blockquote><p class="non-relevant">So you know about an unspecified issue with an unspecified program. It&#8217;s not much to argue that the current behaviour is broken.</p><tr id="id_9"><td class="user">Wouter Verhelst<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00207.html">2005/10/06 12:22:02</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Klaus Ethgen</p>
<p class="with-author non-relevant">No, I just do not remember which software it was. I absolutely remember <span class="caps">THAT</span> it was a problem with localhost.localdomain and <span class="caps">THAT</span> it takes me long time to debug.</p>
</blockquote><p class="non-relevant">That&#8217;s not helpful.</p><p>Problems can have many causes. One of them may be that localhost.localdomain is unexpected; another may be that the software you were using is buggy, or misconfigured. Also, it could be that the problem you experienced back then has been fixed in the mean time.</p><p class="non-relevant">There&#8217;s only one way to be sure, and that is to examine the problem in detail. If it is clear from your example that localhost.localdomain does indeed cause many problems, we could consider not using it by default anymore. However, if we find that the problem is just a bug, it would be better to fix it rather than removing something which many people expect to be there.</p><p class="non-relevant">Since you&#8217;re not providing details, however, this isn&#8217;t possible, and the only sensible course of action is to ignore your claims.</p><tr id="id_10"><td class="user">Klaus Ethgen<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00209.html">2005/10/06 12:42:59</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Wouter Verhelst</p>
<p class="with-author non-relevant">That&#8217;s not helpful.</p>
</blockquote><p class="non-relevant">True. Thats the reason why I give more helpfull information too in the first mail.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Wouter Verhelst</p>
<p class="with-author non-relevant">indeed cause many problems, we could consider not using it by default anymore. However, if we find that the problem is just a bug, it would be better to fix it rather than removing something which many people expect to be there.</p>
</blockquote><p class="non-relevant">But why changing &#8220;localhost&#8221; to &#8220;localhost.localdomain&#8221; only for the reason that RedHat doing it? There was everythink OK with the proven &#8220;localhost&#8221;-entry. No problemes was encounted with it. The problemes was at first encounted when changing this localhost entry. It is absolutely irrelevant if the problemes are exactely specified or not. The point is that localhost.localdomain <span class="caps">MAKES</span> problemes. And it is nothing what makes sense either.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Wouter Verhelst</p>
<p class="with-author non-relevant">Since you&#8217;re not providing details, however, this isn&#8217;t possible, and the only sensible course of action is to ignore your claims.</p>
</blockquote><p class="non-relevant">Just do what you whant with it. I do not whant to fight. I know how to edit /etc/hosts. But why the hell should there be so many traps for users who do not know.</p><tr id="id_11"><td class="user">John Hasler<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00216.html">2005/10/06 13:06:10</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Klaus Ethgen</p>
<p class="with-author non-relevant">Thats the reason why I give more helpfull information too in the first mail.</p>
</blockquote><p class="non-relevant">You haven&#8217;t given enough information.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Klaus Ethgen</p>
<p class="with-author non-relevant">But why changing &#8220;localhost&#8221; to &#8220;localhost.localdomain&#8221;...</p>
</blockquote><p class="non-relevant">It wasn&#8217;t changed.  &#8220;localhost.localdomain&#8221; was <em>added</em>.  &#8220;localhost&#8221; is still there.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Klaus Ethgen</p>
<p class="with-author non-relevant">There was everythink OK with the proven &#8220;localhost&#8221;-entry. No problemes was encounted with it.</p>
</blockquote><p class="non-relevant">There were problems that the addition of &#8220;localhost.localdomain&#8221; were intended to solve.  You may not have personally experienced them but many others did.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Klaus Ethgen</p>
<p class="with-author non-relevant">It is absolutely irrelevant if the problemes are exactely specified or not.</p>
</blockquote><p class="non-relevant">If the addition of &#8220;localhost.localdomain&#8221; caused you a problem we need to know exactly what it was so that we can fix it.</p><tr id="id_12"><td class="user">Henrique de Moraes Holschuh<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00221.html">2005/10/06 13:35:49</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">John Hasler</p>
<p class="with-author non-relevant">It wasn&#8217;t changed.  &#8220;localhost.localdomain&#8221; was <em>added</em>.  &#8220;localhost&#8221; is still there.</p>
</blockquote><p class="non-relevant">The first entry is the canonical name, and it is what the reverse maps to.  So yes, it <span class="caps">WAS</span> changed, and very much so.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">John Hasler</p>
<p class="with-author non-relevant">There were problems that the addition of &#8220;localhost.localdomain&#8221; were intended to solve.  You may not have personally experienced them but many others did.</p>
</blockquote><p class="non-relevant">Now, that is interesting.  Which problems?  I honestly don&#8217;t know of any.</p><tr id="id_13"><td class="user">John Hasler<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00229.html">2005/10/06 14:43:18</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">The first entry is the canonical name, and it is what the reverse maps to.  So yes, it <span class="caps">WAS</span> changed, and very much so.</p>
</blockquote><p class="non-relevant">The OP seemed to me to be implying that &#8220;localhost&#8221; had been deleted and replaced by &#8220;localhost.localdomain&#8221;.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">Now, that is interesting.  Which problems?  I honestly don&#8217;t know of any.</p>
</blockquote><p class="non-relevant">Read the discussion in the bug report.  I think &#8220;localhost.localdomain&#8221; is ugly, but adding it seems much more feasible than fixing all the broken software.</p><tr id="id_14"><td class="user">Henrique de Moraes Holschuh<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00232.html">2005/10/06 15:26:31</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">John Hasler</p>
<p class="with-author non-relevant">Read the discussion in the bug report.  I think &#8220;localhost.localdomain&#8221; is</p>
</blockquote><p class="non-relevant">I did. &#8220;localhost.localdomain&#8221; solved no problems, it was not even related to the problem they were trying to fix, and it certainly is not part of the best compromise solution (add another IP to loopback and use that for the canonical hostname).</p><tr id="id_15"><td class="user">Steve Greenland<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00211.html">2005/10/06 12:31:37</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Wouter Verhelst</p>
<p class="with-author non-relevant">Problems can have many causes. One of them may be that localhost.localdomain is unexpected; another may be that the software you were using is buggy, or misconfigured. Also, it could be that the problem you experienced back then has been fixed in the mean time.</p>
</blockquote><p class="non-relevant">When proposing a variation from long-standing historical practice, shouldn&#8217;t the onus be on the on making the change? What problem does &#8216;localhost.localdomain&#8217; solve? Why is is better than just &#8216;localhost&#8217;, which has been common practice for oh, what, 20+ years?</p><tr id="id_16"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00218.html">2005/10/06 13:25:15</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Steve Greenland</p>
<p class="with-author non-relevant">When proposing a variation from long-standing historical practice, shouldn&#8217;t the onus be on the on making the change? What problem does &#8216;localhost.localdomain&#8217; solve? Why is is better than just &#8216;localhost&#8217;, which has been common practice for oh, what, 20+ years?</p>
</blockquote><p class="non-relevant">It&#8217;s being long-standing does not mean it&#8217;s correct. <span class="relevant">I started looking for any standards or RFCs that require that the address 127.0.0.1 should resolve to &#8220;localhost&#8221; but I could only find some recommendations for <span class="caps">DNS</span> administrators, and nothing about /etc/hosts.</span> Therefore I&#8217;d be inclined to say that if an application does not accept 127.0.0.1 being resolved to e.g. &#8220;foo&#8221; then it is is broken, and this is not changed by the fact that it has been broken for 20+ years.</p><p class="non-relevant"><span class="neutral">There are other long-standing misunderstanding in network setup (just think about the stupidity of &#8220;@hostname &#8212;fqdn@&#8221;).</span> Let&#8217;s fix the bugs in the applications instead of religiously following bad assumptions made in the past.</p><tr id="id_17"><td class="user">Henrique de Moraes Holschuh<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00220.html">2005/10/06 13:33:03</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant">It&#8217;s being long-standing does not mean it&#8217;s correct. I started looking</p>
</blockquote><p class="non-relevant">But it means it is a de-facto standard, which it <strong>is</strong>.  Every *nix system I have mucked around with in the last five years, with the exception of a few Linux distributions, uses plain &#8220;localhost&#8221;.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant"><span class="caps">DNS</span> administrators, and <em>nothing</em> about /etc/hosts. Therefore I&#8217;d be</p>
</blockquote><p class="non-relevant">/etc/hosts is a local implementation detail, it won&#8217;t make it to RFCs while there is still a bit of sanity in the world.  It is probably in a POSIX-like standard, though.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant">inclined to say that if an application does not accept 127.0.0.1 being resolved to e.g. &#8220;foo&#8221; then it is is broken, and this is not changed by the fact that it has been broken for 20+ years.</p>
</blockquote><p class="non-relevant">That is correct, yes.</p><tr id="id_18"><td class="user">Steve Greenland<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00224.html">2005/10/06 13:47:54</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant">It&#8217;s being long-standing does not mean it&#8217;s correct.</p>
</blockquote><p class="non-relevant">No, but it doesn&#8217;t make changing it correct, either.</p><p class="non-relevant">Again: what actual technical problem is solved by &#8216;localhost.localdomain&#8221;? Is solving that problem worth the potential breakage of existing code that assumes gethostbyaddr(127.0.0.1) == &#8220;localhost&#8221;. Note that I&#8217;m not arguing such code is correct, but I don&#8217;t see the need to pointlessly break it.</p><p class="non-relevant">There are lots of long-standing characteristics of Unix systems that are not required by RFCs or Posix standards, yet we don&#8217;t go about arbitrarily changing them.</p><tr id="id_19"><td class="user">Lionel Elie Mamane<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00285.html">2005/10/07 06:12:38</a><td class="message"><blockquote class="with-author">
<p class="with-author">Gabor Gombas</p>
<p class="with-author"><span class="non-relevant">It&#8217;s being long-standing does not mean it&#8217;s correct.</span> I started looking for any standards or RFCs that require that the address 127.0.0.1 should resolve to &#8220;localhost&#8221; but I could only find some recommendations for <span class="caps">DNS</span> administrators, and <em>nothing</em> about /etc/hosts.</p>
</blockquote><p><span class="relevant">Having the <span class="caps">DNS</span> and /etc/hosts give different results is asking for trouble.</span> <span class="caps">RFC</span> 1912 says that this discussion was had in the past and the conclusion was &#8220;localhost.&#8221;.</p><tr id="id_20"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00306.html">2005/10/07 11:54:39</a><td class="message"><blockquote class="with-author">
<p class="with-author">Lionel Elie Mamane</p>
<p class="with-author">Having the <span class="caps">DNS</span> and /etc/hosts give different results is asking for trouble. <span class="caps">RFC</span> 1912 says that this discussion was had in the past and the conclusion was &#8220;localhost.&#8221;.</p>
</blockquote><p>Note that that discussion was about appending the local (i.e. a real, existing) domain to localhost, and that indeed is problematic (first of all, there is <em>no</em> single &#8220;local domain&#8221; for multi-homed machines).</p><p>Appending a non-existent <span class="caps">TLD</span> to localhost is somewhat different, and is not addressed in the <span class="caps">RFC</span>.</p><tr id="id_21"><td class="user">Stefano Zacchiroli<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00215.html">2005/10/06 13:17:53</a><td class="message"><blockquote class="with-author">
<p class="with-author">Klaus Ethgen</p>
<p class="with-author">I cannot specify it. But I remember that I did search for problemes in the past long time to find a error. And it was an entry of localhost.localdomain in a /etc/hosts. Maybe it was <span class="caps">PVM</span> or MySQL or other. I&#8217;m not sure.</p>
</blockquote><p><span class="caps">IIRC</span> leafnode complains about &#8220;localhost.localdomain&#8221; refusing to suck news unless you manually specify a domainname in its configuration file.  Maybe you remember that trouble?</p><p>Still, I&#8217;ve ever considered that an issue with leafnode, not of &#8220;localhost.localdomain&#8221;.</p><tr id="id_22"><td class="user">Mark Brown<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00259.html">2005/10/06 20:38:03</a><td class="message"><blockquote class="with-author">
<p class="with-author">Stefano Zacchiroli</p>
<p class="with-author"><span class="caps">IIRC</span> leafnode complains about &#8220;localhost.localdomain&#8221; refusing to suck news unless you manually specify a domainname in its configuration file.  Maybe you remember that trouble?</p>
<p class="with-author">Still, I&#8217;ve ever considered that an issue with leafnode, not of &#8220;localhost.localdomain&#8221;.</p>
</blockquote><p>It&#8217;s complaining because upstream wishes to strongly encourage users to configure things so that they have a globally unique hostname part to message IDs that are generated by Leafnode in order to minimise the risk of collisions.  It will do the same thing for a few other things that look like default or incomplete configurations.</p><tr id="id_23"><td class="user">Stefano Zacchiroli<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00261.html">2005/10/06 20:41:13</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Mark Brown</p>
<p class="with-author non-relevant">It&#8217;s complaining because upstream wishes to strongly encourage users to configure things so that they have a globally unique hostname part to message IDs that are generated by Leafnode in order to minimise the risk</p>
</blockquote><p class="non-relevant"><span class="caps">IMHO</span> is too much to inhibit the use of the program as a whole just to minimize the collision risk, a warning would have been enough. But we are getting OT(hread) here &#8230;</p><tr id="id_24"><td class="user">Mark Brown<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00263.html">2005/10/06 21:07:50</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Stefano Zacchiroli</p>
<p class="with-author non-relevant"><span class="caps">IMHO</span> is too much to inhibit the use of the program as a whole just to minimize the collision risk, a warning would have been enough. But we are getting OT(hread) here &#8230;</p>
</blockquote><p class="non-relevant">I don&#8217;t believe I indicated anything except the views of upstream there.</p><tr id="id_25"><td class="user">John Hasler<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00266.html">2005/10/06 21:14:45</a><td class="message"><blockquote class="with-author">
<p class="with-author">Stefano Zacchiroli</p>
<p class="with-author"><span class="caps">IMHO</span> is too much to inhibit the use of the program as a whole just to minimize the collision risk, a warning would have been enough.</p>
</blockquote><p>Particularly considering that there are better ways to assure the uniqueness of message-ids anyway.</p><tr id="id_26"><td class="user">Henrique de Moraes Holschuh<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00219.html">2005/10/06 13:28:02</a><td class="message"><blockquote class="with-author">
<p class="with-author">Marco d&#8217;Itri</p>
<p class="with-author">Please explain which troubles.</p>
</blockquote><p class="relevant">Some programs will try to solve the reverse for 127.0.0.1, during normal operations (not to verify <span class="caps">WHAT</span> 127.0.0.1 points to, but because it is doing reverse <span class="caps">DNS</span> for every connection, and one just came over lo).</p><p class="relevant">Some of these programs, due to utter braindamage, special-case the string &#8220;localhost&#8221;.  Change that, and they break.  <span class="neutral">Mysql is the highest profile case, apparently.</span></p><p class="non-relevant">Still, <span class="caps">WHAT</span> does a canonical name of localhost.localdomain. for 127.0.0.1 brings us?  It is completely useless, it adds no extra functionality over a plain canonical name of &#8220;localhost&#8221;.  And it breaks badly designed applications.  While it pains me to say so (I absolutely <strong>loathe</strong> bad design), reverting that completely useless change looks like a very good idea to me.</p><tr id="id_27"><td class="user">Russ Allbery<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00245.html">2005/10/06 18:00:29</a><td class="message"><blockquote class="with-author">
<p class="with-author">Marco d&#8217;Itri</p>
<p class="with-author">Please explain which troubles.</p>
</blockquote><p>See the news.software.nntp traffic with people having strange problems with pathnames and message ID generation because of .localdomain.  There have been a few separate cases of that over the past year or so.</p><tr id="id_28"><td class="user">Marco d&#39;Itri<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00249.html">2005/10/06 18:23:41</a><td class="message"><blockquote class="with-author">
<p class="with-author">Russ Allbery</p>
<p class="with-author">See the news.software.nntp traffic with people having strange problems with pathnames and message ID generation because of .localdomain.  There have been a few separate cases of that over the past year or so.</p>
</blockquote><p>Not relevant. They would have the same problems with 127.0.0.1 = localhost.</p><p>(Not that I&#8217;m arguing either way, anyway.)</p><tr id="id_29"><td class="user">Russ Allbery<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00255.html">2005/10/06 19:44:34</a><td class="message"><blockquote class="with-author">
<p class="with-author">Marco d&#8217;Itri</p>
<p class="with-author">Not relevant. They would have the same problems with 127.0.0.1 = localhost.</p>
</blockquote><p>No, they won&#8217;t, because <span class="caps">INN</span> ignores hostnames that do not contain a period for the purposes of generating external identifiers, specifically to keep from using things like localhost or other unqualified names that aren&#8217;t globally unique.  Adding the pointless .localdomain thing breaks that sort of simple sanity check.</p><tr id="id_30"><td class="user">John Hasler<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00265.html">2005/10/06 21:12:39</a><td class="message"><blockquote class="with-author">
<p class="with-author">Russ Allbery</p>
<p class="with-author">No, they won&#8217;t, because <span class="caps">INN</span> ignores hostnames that do not contain a period for the purposes of generating external identifiers, specifically to keep from using things like localhost or other unqualified names that aren&#8217;t globally unique.</p>
</blockquote><p>Relying on hostnames either with or without periods for uniqueness is both broken and unnecessary.</p><tr id="id_31"><td class="user">Russ Allbery<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00267.html">2005/10/06 21:31:15</a><td class="message"><blockquote class="with-author">
<p class="with-author">John Hasler</p>
<p class="with-author">Relying on hostnames either with or without periods for uniqueness is both broken and unnecessary.</p>
</blockquote><p>Would you like to propose an alternate approach that satisfies all of the constraints that <span class="caps">INN</span> is operating under?  Presumably, given that you feel capable of expressing this strong of an opinion, you already know what all of those constraints are and are already familiar with the issues.</p><tr id="id_32"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00309.html">2005/10/07 12:02:13</a><td class="message"><blockquote class="with-author">
<p class="with-author">Russ Allbery</p>
<p class="with-author">No, they won&#8217;t, because <span class="caps">INN</span> ignores hostnames that do not contain a period for the purposes of generating external identifiers, specifically to keep from using things like localhost or other unqualified names that aren&#8217;t globally unique.  Adding the pointless .localdomain thing breaks that sort of simple sanity check.</p>
</blockquote><p>Hmm, how would <span class="caps">INN</span> react if it sees a &#8220;normal-looking&#8221; name (like foo.bar.com) that in turn resolves to 127.0.0.1? It&#8217;s been a long time since I last run a news server and I used Diablo instead of <span class="caps">INN</span> so I&#8217;m not familiar with INN&#8217;s internals. But it seems <span class="caps">INN</span> is relying on a broken heuristics&#8230;</p><tr id="id_33"><td class="user">Russ Allbery<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00326.html">2005/10/07 18:18:57</a><td class="message"><blockquote class="with-author">
<p class="with-author">Gabor Gombas</p>
<p class="with-author">Hmm, how would <span class="caps">INN</span> react if it sees a &#8220;normal-looking&#8221; name (like foo.bar.com) that in turn resolves to 127.0.0.1? It&#8217;s been a long time since I last run a news server and I used Diablo instead of <span class="caps">INN</span> so I&#8217;m not familiar with INN&#8217;s internals. But it seems <span class="caps">INN</span> is relying on a broken heuristics&#8230;</p>
</blockquote><p><span class="caps">INN</span> applies the following heuristic to determine the Path header and the hostname for the message ID if not otherwise configured:</p><ul>
<li>Obtain the system host name with gethostname().</li>
<li>Look up an IP address for that host with gethostbyname().</li>
<li>Look up the names associated with that address with gethostbyaddr().</li>
<li>Walk the alias list of the result and find the first name containing a period.</li>
</ul><p>A simple line of:</p><pre>127.0.0.1  localhost localhost.localdomain
</pre><p>by itself doesn&#8217;t cause problems.  It does, however, make it much easier for a common misconfiguration to result.  That misconfiguration happens when users put the unqualified local hostname on the 127.0.0.1 line (a configuration that follows an old mistaken but common Unix practice, putting the unqualified hostname on every line of /etc/hosts).  Then, the above algorithm ends up returning localhost.localdomain rather than the actual system hostname if the standard practice of listing 127.0.0.1 first is followed.</p><p>A user misconfiguration is needed <strong>on top of</strong> localhost.localdomain for this to be a problem, but that misconfiguration is not uncommon and (most tellingly) having localhost.localdomain there solves <strong>no</strong> actual real-world problems.  It&#8217;s just a time bomb.</p><p>You can see from the above that if the user puts their complete hostname on 127.0.0.1, <span class="caps">INN</span> does just fine <strong>provided</strong> that localhost.localdomain isn&#8217;t listed before it.  It also does fine if the user explicitly configures this part of <span class="caps">INN</span>, but as with most software, it&#8217;s best to figure out reasonable defaults where possible.  This code has worked reasonably well for 13 years, except on systems with localhost.localdomain and this misconfiguration.</p><p>We could special-case localhost.localdomain, but why?  What purpose does it serve to have that name in /etc/hosts?</p><tr id="id_34"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00756.html">2005/10/20 13:56:47</a><td class="message"><blockquote class="with-author">
<p class="with-author">Russ Allbery</p>
<p class="with-author">* Obtain the system host name with gethostname().<br />
* Look up an IP address for that host with gethostbyname().</p>
</blockquote><p>The bug is here. This is completely wrong but sadly very common practice. It is common because it is portable and works with some simple configurations (namely, single-homed machines with static IP address).</p><blockquote class="with-author">
<p class="with-author">Russ Allbery</p>
<p class="with-author">* Look up the names associated with that address with gethostbyaddr().<br />
* Walk the alias list of the result and find the first name containing a period.</p>
</blockquote><p>The proper fix would be to enumerate all IP addresses of all network interfaces and select one that has an appropriate name. Unfortunately this is non-trivial and highly OS-dependent, although the libdumbnet1 package provides a platform-independent <span class="caps">API</span> for this (among other things).</p><tr id="id_35"><td class="user">Olaf van der Spek<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00759.html">2005/10/20 14:16:40</a><td class="message"><blockquote class="with-author">
<p class="with-author">Gabor Gombas</p>
<p class="with-author">The proper fix would be to enumerate all IP addresses of all network interfaces and select one that has an appropriate name. Unfortunately this is non-trivial and highly OS-dependent, although the libdumbnet1 package provides a platform-independent <span class="caps">API</span> for this (among other things).</p>
</blockquote><p>Wouldn&#8217;t the proper fix be to not use source address based authentication?</p><tr id="id_36"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00760.html">2005/10/20 14:26:25</a><td class="message"><blockquote class="with-author">
<p class="with-author">Olaf van der Spek</p>
<p class="with-author">Wouldn&#8217;t the proper fix be to not use source address based authentication?</p>
</blockquote><p>This is not authentication. <span class="caps">INN</span> just need a string to uniquely identify a host. Using a <span class="caps">FQDN</span> is OK, it&#8217;s just the way of obtaining that <span class="caps">FQDN</span> that is problematic.</p><tr id="id_37"><td class="user">Olaf van der Spek<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00761.html">2005/10/20 14:29:40</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant">This is not authentication. <span class="caps">INN</span> just need a string to uniquely identify a host. Using a <span class="caps">FQDN</span> is OK, it&#8217;s just the way of obtaining that <span class="caps">FQDN</span> that is problematic.</p>
</blockquote><p class="non-relevant">Ah, I was thinking about the MySQL case.</p><tr id="id_38"><td class="user">Russ Allbery<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg01242.html">2005/11/01 05:49:26</a><td class="message"><blockquote class="with-author">
<p class="with-author">Gabor Gombas</p>
<p class="with-author">The bug is here. This is completely wrong but sadly very common practice. It is common because it is portable and works with some simple configurations (namely, single-homed machines with static IP address).</p>
</blockquote><p>Well, I don&#8217;t really agree with the statement that it&#8217;s completely wrong, but I do understand what you&#8217;re saying about the semantic mismatch at work here.</p><blockquote class="with-author">
<p class="with-author">Gabor Gombas</p>
<p class="with-author">The proper fix would be to enumerate all IP addresses of all network interfaces and select one that has an appropriate name. Unfortunately this is non-trivial and highly OS-dependent, although the libdumbnet1 package provides a platform-independent <span class="caps">API</span> for this (among other things).</p>
</blockquote><p>You&#8217;ve pretty much covered in that paragraph the reasons why <span class="caps">INN</span> can&#8217;t take that approach.  :)  I know how hard this is from watching <span class="caps">MIT</span> Kerberos try to solve this problem and don&#8217;t want to touch this portability nightmare with a ten-foot pole.</p><tr id="id_39"><td class="user">Christoph Haas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00317.html">2005/10/07 14:15:18</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Marco d&#8217;Itri</p>
<p class="with-author non-relevant">Please explain which troubles.</p>
</blockquote><p class="non-relevant">Mine with MySQL. And the reason why I initiated this thread. :)</p><p class="non-relevant">MySQL definitely chokes on localhost.localdomain. And although MySQL will adopt to distributions using &#8220;localhost.localdomain&#8221; instead of &#8220;localhost&#8221; doesn&#8217;t mean it&#8217;s correct. MySQL by default expects &#8220;localhost&#8221; as the hostname assigned to the loopback interface. And there is difference between &#8220;localhost&#8221; (special meaning) and &#8220;localhost.localdomain&#8221; (some hostname) for MySQL.</p><p class="non-relevant">&#8220;RedHat does it&#8221; isn&#8217;t a good argument for me either. Inheriting unneeded entries should be thought about. I don&#8217;t think it&#8217;s the right way to expect all the software to add hacks to detect &#8220;localhost.localdomain&#8221;.</p><p class="non-relevant">So still I&#8217;m removing the localhost.localdomain after every installation.  Somehow I&#8217;m not happy about it.</p><p class="non-relevant">Apparently this discussion has been done a year ago already and nothing resulted from it. I hope we are getting somewhere this time.</p><tr id="id_40"><td class="user">Joey Hess<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00350.html">2005/10/08 22:17:17</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Klaus Ethgen</p>
<p class="with-author non-relevant">The only reason I find is that RedHat use it. But RedHat shouldn&#8217;t be debians requirement of quality. It should be other way around. RedHat is such a buggy distribution. And it gets more and more worse every upgrade.</p>
</blockquote><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Klaus Ethgen</p>
<p class="with-author non-relevant">But why changing &#8220;localhost&#8221; to &#8220;localhost.localdomain&#8221; only for the reason that RedHat doing it?</p>
</blockquote><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Christoph Haas</p>
<p class="with-author non-relevant">&#8220;RedHat does it&#8221; isn&#8217;t a good argument for me either.</p>
</blockquote><p class="non-relevant">I&#8217;d just like to point out that the whole idea that this was somehow influenced by Red Hat is a red er, herring. d-i is a thouroguhly <span class="caps">NIH</span> enterprise, we obviously don&#8217;t follow the lead of Red Hat.</p><p class="non-relevant">In the future, please try to limit your posts to those that contain provable facts.jk</p><tr id="id_41"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00757.html">2005/10/20 14:01:15</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Christoph Haas</p>
<p class="with-author non-relevant">MySQL definitely chokes on localhost.localdomain. And although MySQL will adopt to distributions using &#8220;localhost.localdomain&#8221; instead of &#8220;localhost&#8221; doesn&#8217;t mean it&#8217;s correct. MySQL by default expects &#8220;localhost&#8221; as the hostname assigned to the loopback interface.</p>
</blockquote><p class="non-relevant">No, MySQL is happy to use whatever name the loopback interface has; it is the MySQL <em>documentation</em> that stresses the &#8220;localhost&#8221; string without mentioning that it depends on the naming service configuration.</p><p class="non-relevant">So the bug is that the documentation does not describe what the code really does; you have to fix one or the other. Upstream went with modifying the code rather than the documentation, and I agree with them.</p><tr id="id_42"><td class="user">Christoph Haas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00763.html">2005/10/20 14:58:52</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant">No, MySQL is happy to use whatever name the loopback interface has; it is the MySQL <em>documentation</em> that stresses the &#8220;localhost&#8221; string without mentioning that it depends on the naming service configuration.</p>
</blockquote><p class="non-relevant">Thanks for the clarification. Since I didn&#8217;t feel like reading the source code of MySQL I relied on its documentation. And it was a bit confusing (not only to me). So MySQL is happy with whatever name is bound to the lo interface. Good to know.</p><tr id="id_43"><td class="user">Klaus Ethgen<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00764.html">2005/10/20 15:01:12</a><td class="message"><blockquote class="with-author">
<p class="with-author">Gabor Gombas</p>
<p class="with-author">No, MySQL is happy to use whatever name the loopback interface has; it is the MySQL <em>documentation</em> that stresses the &#8220;localhost&#8221; string without mentioning that it depends on the naming service configuration.</p>
</blockquote><p>Thats not completely true. MySQL use the name &#8220;localhost&#8221; to select a other connection methode (socket). If you use the ip or localhost.localdomain it tries to connect bei network which is much slower.</p><tr id="id_44"><td class="user">Henrique de Moraes Holschuh<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00231.html">2005/10/06 15:24:12</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant"><span class="caps">IIRC</span> The main reason was described in <a href="http://tinyurl.com/2an2ujy">#247734</a></p>
</blockquote><p class="non-relevant">ARGH!</p><p class="non-relevant">If that bug was the reason why the localhost entry in /etc/hosts was changed, then please fix it right back to what it was.</p><p class="non-relevant">The localhost.localdomain stuff appeared from nowhere in an email by Pierre Machard during the discursion, and stayed on all other examples while people tried to fix an issue (which has a fucking old proper solution, which is to use another loopback IP and if needed, another lo alias) that had nothing to do with it.</p><p class="non-relevant">Pierre, <span class="caps">WHY</span> do you need localhost.localdomain? That is <span class="caps">NOT</span> clear in the bug report.  And the rest of the bug report is about another issue completely, dealing with people not being able to grasp the idea that if you need a canonical hostname other than localhost, you need another interface (which can be &#8220;lo&#8221; just as well, but give it another IP).</p><tr id="id_45"><td class="user">Pierre Machard<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00242.html">2005/10/06 17:44:42</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">ARGH!</p>
<p class="with-author non-relevant">If that bug was the reason why the localhost entry in /etc/hosts was changed, then please fix it right back to what it was.</p>
<p class="with-author non-relevant">The localhost.localdomain stuff appeared from nowhere in an email by Pierre Machard during the discursion, and stayed on all other examples while people tried to fix an issue (which has a fucking old proper solution, which is to use another loopback IP and if needed, another lo alias) that had nothing to do with it.</p>
</blockquote><p class="non-relevant">I can not remember precisely. I think that at that time I was testing the debian-installer and I saw it was taken a long while to boot. I saw that my system had no <span class="caps">FQDN</span> (hostname -f). When you add .localdomain, the <span class="caps">FQDN</span> is complete and it helps to solve timeout in several application.</p><p class="non-relevant">Anyway I do not understand why this issue is a problem since we simply add an alias to localhost. Nobody say  that we will remove localhost and exchange it by localhost.localdomain.</p><tr id="id_46"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00247.html">2005/10/06 18:18:36</a><td class="message"><blockquote class="with-author">
<p class="with-author">Pierre Machard</p>
<p class="with-author">I can not remember precisely. I think that at that time I was testing the debian-installer and I saw it was taken a long while to boot. I saw that my system had no <span class="caps">FQDN</span> (hostname -f). When you add .localdomain, the <span class="caps">FQDN</span> is complete and it helps to solve timeout in several application.</p>
</blockquote><p class="relevant">So it was just papering over a real bug, namely the existence of the &#8220;-f&#8221; option of hostname. &#8220;hostname -f&#8221; assumes that the hostname (as returned by gethostname(3)) has something to do with networking, which is false. It also assumes that the system has just one IP address with one <span class="caps">FQDN</span> which is also false.</p><p class="relevant">This is a perfect example of a long-standing assumption that was wrong from the start but tended to work in the past when the wast majority of computers had really just one network interface with one IP address, and the few machines having multiple NICs/multiple IP addresses had good sysadmins who could deal with the breakage caused by this assumption.</p><p class="relevant">Nowadays even desktop boards start to come with multiple NICs on-board so this &#8220;one IP &#8211; one FQDN&#8221; assumption must be stopped. &#8220;hostname -f&#8221; must be killed, and everything that uses it must be fixed. Well, it may take some time to sort out all the details, there are a <em>lot</em> of broken programs out there&#8230;</p><blockquote class="with-author">
<p class="with-author">Pierre Machard</p>
<p class="with-author">Anyway I do not understand why this issue is a problem since we simply add an alias to localhost. Nobody say  that we will remove localhost and exchange it by localhost.localdomain.</p>
</blockquote><p>Broken software compares reverse_lookup({127.0.0.1}) with the string &#8220;localhost&#8221; and is surprised when it gets <span class="caps">FALSE</span> due to the reverse lookup returning &#8220;localhost.localdomain&#8221; instead of just &#8220;localhost&#8221;.</p><tr id="id_47"><td class="user">Bernd Eckenfels<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00282.html">2005/10/07 02:45:24</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant">So it was just papering over a real bug, namely the existence of the &#8220;-f&#8221; option of hostname. &#8220;hostname -f&#8221; assumes that the hostname (as returned by gethostname(3)) has something to do with networking, which is false. It also assumes that the system has just one IP address with one <span class="caps">FQDN</span> which is also false.</p>
</blockquote><p class="non-relevant">Those asumptions are not false, they are what they are: asumptions. If you dont want to configure your system that way, just dont use it.</p><tr id="id_48"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00310.html">2005/10/07 12:04:44</a><td class="message"><blockquote class="with-author">
<p class="with-author">Bernd Eckenfels</p>
<p class="with-author">Those asumptions are not false, they are what they are: asumptions. If you dont want to configure your system that way, just dont use it.</p>
</blockquote><p>That is what I say: every Debian package that uses &#8220;hostname -f&#8221; is bogus, because it relies on a certain system configuration.</p><tr id="id_49"><td class="user">Bernd Eckenfels<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00325.html">2005/10/07 17:54:47</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant">That is what I say: every Debian package that uses &#8220;hostname -f&#8221; is bogus, because it relies on a certain system configuration.</p>
</blockquote><p class="non-relevant">Umm, I guess all debian packages relies on certain configurations.</p><tr id="id_50"><td class="user">Henrique de Moraes Holschuh<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00248.html">2005/10/06 18:23:45</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant">Anyway I do not understand why this issue is a problem since we</p>
</blockquote><p class="non-relevant">Because instead of doing this:</p><pre class="non-relevant">127.0.0.1 localost localhost.localdomain
</pre><p class="non-relevant">It was done like this:</p><pre class="non-relevant">127.0.0.1 localhost.localdomain localhost
</pre><p class="non-relevant">Thus changing the canonical name of the loopback interface.  <span class="caps">PLEASE</span> do not do this unless you have <strong>extremely</strong> good reasons to do so.  An untracked <span class="caps">DNS</span> timeout is definately not one.  If you can still reproduce the problem, we can work on tracking that thing down without the localhost.localdomain.</p><p class="non-relevant">Add a new loopback interface (say, 127.0.0.2) and name it however you want.  That will not break anything at all, and it allows you to name your system in whatever way you might want.  This is what d-i should be doing, it is the maximum compatibility path.</p><p class="non-relevant">You don&#8217;t even need to add a new interface if you use iproute instead of outdated ifconfig crap, and you might get away without even that much (but I wouldn&#8217;t try it, I don&#8217;t think trying to bind a socket to an IP that is not local (even if it pings because of lo and the /8 netmask) is a very safe thing to do).</p><tr id="id_51"><td class="user">Marco d&#39;Itri<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00250.html">2005/10/06 18:26:48</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">Because instead of doing this:</p>
<p class="with-author non-relevant">127.0.0.1 localost localhost.localdomain</p>
<p class="with-author non-relevant">It was done like this:</p>
<p class="with-author non-relevant">127.0.0.1 localhost.localdomain localhost</p>
<p class="with-author non-relevant">Thus changing the canonical name of the loopback interface.  <span class="caps">PLEASE</span> do not do this unless you have <strong>extremely</strong> good reasons to do so.  An untracked <span class="caps">DNS</span></p>
</blockquote><p class="non-relevant">Agreed.</p><p class="relevant">Another point is that it would be bad to have 127.0.0.1 resolve differently in /etc/hosts and <span class="caps">DNS</span> (we ship a 127.in-addr.arpa zone).</p><tr id="id_52"><td class="user">Pierre Machard<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00251.html">2005/10/06 18:55:13</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">Because instead of doing this:</p>
<p class="with-author non-relevant">127.0.0.1 localost localhost.localdomain</p>
<p class="with-author non-relevant">It was done like this:</p>
<p class="with-author non-relevant">127.0.0.1 localhost.localdomain localhost</p>
<p class="with-author non-relevant">Thus changing the canonical name of the loopback interface.  <span class="caps">PLEASE</span> do not do this unless you have <strong>extremely</strong> good reasons to do so.  An untracked <span class="caps">DNS</span> timeout is definately not one.  If you can still reproduce the problem, we can work on tracking that thing down without the localhost.localdomain.</p>
</blockquote><p class="non-relevant">The fact is that nobody complained about that&#8230; and my bug was repported more than one year and a half ago. Plus It was disscussed on debian-devel. Please do not argue with me!</p><p class="non-relevant">I do not pretend that I know anything in name resolution, however I proposed something that worked on my system. It was widely discussed. I joined this current thread to show people who do not read -devel every day that we have already talk about it. Nothing more, nothing less.</p><p class="non-relevant">Please have a look at <a href="http://lists.debian.org/debian-devel/2004/06/thrd2.html">Subject: /etc/hosts: Two lines with the same IP address?</a> by Thomas Hood</p><tr id="id_53"><td class="user">Henrique de Moraes Holschuh<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00256.html">2005/10/06 19:56:05</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant">The fact is that nobody complained about that&#8230; and my bug was</p>
</blockquote><p class="non-relevant">Now we are :)</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant">repported more than one year and a half ago. Plus It was disscussed on debian-devel. Please do not argue with me!</p>
</blockquote><p class="non-relevant">It is nothing personal&#8230; it is just that your email was the first one mentioning the .localdomain thing, I wanted to know why you needed it.</p><p class="non-relevant">Heck, I had never noticed that all my new sarge installs had this broken thing in them (but now I will have to quadruple-check mysql to make sure it is not doing something idiotic behind my back.  I am pleasantly surprised that it did not go up in flames, so maybe they fixed their localhost braindamage).</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant">proposed something that worked on my system. It was widely discussed. I joined this current thread to show people who do not read -devel every day that we have already talk about it. Nothing more, nothing less.</p>
</blockquote><p class="non-relevant">It was useful, at least now we know the history of the change, and thus we can deal better with it.  Thanks.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant">Please have a look at <a href="http://lists.debian.org/debian-devel/2004/06/thrd2.html">Subject: /etc/hosts: Two lines with the same IP address?</a> by Thomas Hood</p>
</blockquote><p class="non-relevant">With a subject line like that, I certain would never expect it to be related to 127.0.0.1 canonical naming&#8230; no wonder I never noticed the thread.</p><tr id="id_54"><td class="user">Joey Hess<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00254.html">2005/10/06 19:05:17</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">Because instead of doing this:</p>
<p class="with-author non-relevant">127.0.0.1 localost localhost.localdomain</p>
<p class="with-author non-relevant">It was done like this:</p>
<p class="with-author non-relevant">127.0.0.1 localhost.localdomain localhost</p>
<p class="with-author non-relevant">Thus changing the canonical name of the loopback interface.  <span class="caps">PLEASE</span> do not do this unless you have <strong>extremely</strong> good reasons to do so.  An untracked <span class="caps">DNS</span> timeout is definately not one.  If you can still reproduce the problem, we can work on tracking that thing down without the localhost.localdomain.</p>
</blockquote><p class="non-relevant"><span class="caps">FWIW</span>, it was done as a result of bug <a href="http://tinyurl.com/2an2ujy">#247734</a>, which includes details on how every possible choice seems to break something and the reasoning that led to the current choice.</p>

<blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">Add a new loopback interface (say, 127.0.0.2) and name it however you want.  That will not break anything at all, and it allows you to name your system in whatever way you might want.  This is what d-i should be doing, it is the maximum compatibility path.</p>
</blockquote>

<p class="non-relevant">Already done:</p>

<p class="non-relevant">netcfg (1.13) unstable; urgency=low</p>

<p class="non-relevant">[ Thomas Hood ]</p>

<ul class="non-relevant">
<li>If there is no permanent IP address with which the system hostname (i.e., that which is returned by the &#8220;hostname&#8221; command) can be associated in /etc/hosts then associate it with address 127.0.1.1 rather than 127.0.0.1.  Associating the system hostname with the latter had the unwanted effect of making &#8216;localhost.localdomain&#8217; the canonical hostname associated with the system hostname.  That is, &#8216;hostname &#8212;fqdn&#8217; returned &#8216;localhost.localdomain&#8217;.</li>
</ul>

<p class="non-relevant">(Closes: #316099)</p>

<p class="non-relevant">Programs that access local services at the IP address obtained by resolving the system hostname <span class="caps">SHOULD</span> <span class="caps">NOT</span> DO <span class="caps">THIS</span>, but those that do so will not be disappointed: most services that listen locally listen on all 127/8 addresses, not just on 127.0.0.1.</p>

<p class="non-relevant">&#8212; Frans Pop <fjp@debian.org>  Fri, 19 Aug 2005 21:08:39 +0200</p><tr id="id_55"><td class="user">Henrique de Moraes Holschuh<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00257.html">2005/10/06 20:02:55</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Joey Hess</p>
<p class="with-author non-relevant"><span class="caps">FWIW</span>, it was done as a result of bug <a href="http://tinyurl.com/2an2ujy">#247734</a>, which includes details on how every possible choice seems to break something and the reasoning that led to the current choice.</p>
</blockquote><p class="non-relevant">I read that bug report <span class="caps">VERY</span> carefully. Twice. There is <strong>nothing</strong> there that seems to have been fixed/addressed by .localdomain, except maybe a <span class="caps">DNS</span> timeout in Pierre&#8217;s machine.  Everything else deals with the hostname.</p><p class="non-relevant">Or am I getting confused and d-i uses localhost.localdomain as the default hostname, and say, if I had told it that my machine is named &#8220;twerk&#8221;, domain &#8220;foo.bar&#8221; I would get a</p><pre class="non-relevant">127.0.0.1 twerk.foo.bar twerk localhost
</pre><p class="non-relevant">entry in /etc/hosts?</p><p class="non-relevant">That would explain a lot&#8230;  but still make such a &#8220;fix&#8221; quite a bad idea.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Joey Hess</p>
<p class="with-author non-relevant">Programs that access local services at the IP address obtained by resolving the system hostname <span class="caps">SHOULD</span> <span class="caps">NOT</span> DO <span class="caps">THIS</span>, but those that do so will not be disappointed: most services that listen locally listen on all 127/8 addresses, not just on 127.0.0.1.</p>
</blockquote><p class="non-relevant">This could cause trouble that is easily avoided by actually adding an extra loopback address to lo (or a lo:1 alias if you have to use ifconfig) of 127.0.1.1.  This is harmless and could be added statically and unconditionally to /etc/network/interfaces.</p><tr id="id_56"><td class="user">Mark Brown<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00262.html">2005/10/06 20:46:42</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">Or am I getting confused and d-i uses localhost.localdomain as the default hostname, and say, if I had told it that my machine is named &#8220;twerk&#8221;, domain &#8220;foo.bar&#8221; I would get a</p>
<p class="with-author non-relevant">127.0.0.1 twerk.foo.bar twerk localhost</p>
<p class="with-author non-relevant">entry in /etc/hosts?</p>
<p class="with-author non-relevant">That would explain a lot&#8230;  but still make such a &#8220;fix&#8221; quite a bad idea.</p>
</blockquote><p class="non-relevant">There was certainly a problem at one point where attempting to cannoicalise the hostname of a freshly installed system would result in a localhost address.  That was fixed prior to the sarge release and <span class="caps">IIRC</span> the localhost.localdomain thing was already there before this was fixed, though I&#8217;ve not checked.</p><tr id="id_57"><td class="user">Wesley J. Landaker<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00270.html">2005/10/06 23:39:04</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">I read that bug report <span class="caps">VERY</span> carefully. Twice. There is <strong>nothing</strong> there that seems to have been fixed/addressed by .localdomain, except maybe a <span class="caps">DNS</span> timeout in Pierre&#8217;s machine.  Everything else deals with the hostname.</p>
</blockquote><p class="non-relevant"><span class="caps">FWIW</span>, I completely agree with Henrique here (and pretty much in all past messages in this thread)&#8212;I also read that bug report <span class="caps">VERY</span> carefully, and I do not see how adding .localdomain had anything to do with the resolution of that bug.</p><p class="non-relevant">I believe that localhost.localdomain should be removed, as it is both unnecessary and arbitrary.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">Or am I getting confused and d-i uses localhost.localdomain as the default hostname, and say, if I had told it that my machine is named &#8220;twerk&#8221;, domain &#8220;foo.bar&#8221; I would get a</p>
<p class="with-author non-relevant">127.0.0.1 twerk.foo.bar twerk localhost</p>
<p class="with-author non-relevant">entry in /etc/hosts?</p>
<p class="with-author non-relevant">That would explain a lot&#8230;  but still make such a &#8220;fix&#8221; quite a bad idea.</p>
</blockquote><p class="non-relevant">No, on all of my sarge and sid machines the entry looked like:</p><pre class="non-relevant">127.0.0.1 localhost.localdomain localhost foobar
</pre><p class="non-relevant">Where foobar was the name I gave during the install process.</p><tr id="id_58"><td class="user">Joey Hess<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00352.html">2005/10/08 22:53:28</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Henrique de Moraes Holschuh</p>
<p class="with-author non-relevant">I read that bug report <span class="caps">VERY</span> carefully. Twice. There is <strong>nothing</strong> there that seems to have been fixed/addressed by .localdomain, except maybe a <span class="caps">DNS</span> timeout in Pierre&#8217;s machine.  Everything else deals with the hostname.</p>
</blockquote><p class="non-relevant">I don&#8217;t have the stamina that you do, so I&#8217;ve only read random bits of it a half-dozen times. The localhost.localdomain does seems to kind of appear out of the blue half way through and looks very likely to have been glommed in with the rest of the changes by mistake. It&#8217;s hard to tell looking back at the history.</p><p class="non-relevant">Anyway, please bear in mind that it&#8217;s very easy for me to go in and change this line of code:</p><pre class="non-relevant">fprintf(fp, &#34;127.0.0.1\tlocalhost.localdomain\tlocalhost\n&#34;);
</pre><p class="non-relevant">To this:</p><pre class="non-relevant">fprintf(fp, &#34;127.0.0.1\tlocalhost\n&#34;);
</pre><p class="non-relevant">But it&#8217;s then very hard to see if this breaks anything. After all, the relevant change was made in netcfg in July of 2004. For an entire year, it was in every system installed, and nobody complained, although a few of us noticed it and thought it looked a bit strange. Debian released and for months after the release nobody apparently saw fit to complain or report any problems until this thread.</p><p class="non-relevant">If I make any changes, I don&#8217;t want to have them pop up and result in another thread like this<sup class="footnote"><a href="#fn98041868954896931359807654889">1</a></sup> in 1.5 years time when we&#8217;re trying to release, or have just released, etch. Also, I don&#8217;t pretend to be any kind of expert on the absurdly fragile and unintuitive behavior the system exhibits with different flavours of localhost entry in the /etc/hosts file. I&#8217;m just a guy who happens to know where the code is and how to change if it I get a clear explanation of why it&#8217;s broken and why a given change is thuroughly correct.</p><p class="non-relevant">So far, this thread has not yeilded anything I can trust to that degree.</p><p class="non-relevant">Of course this change doesn&#8217;t have to go through me. Joshua Kwan has maintained netcfg in less busy times in his life. Thomas Hood comes as close as any developer does to &#8220;owning&#8221; Debian&#8217;s local resolver setup.  Pulling them into a discussion about this would be a very productive thing to do. They&#8217;d probably be a lot more willing to look at the issues in depth and quickly make an appropriate change.</p><p>Oh yeah, I should point out that I&#8217;ve been seeing various programs in Debian not properly work with various /etc/hosts settings for at least ten years. I belive that the typical thing a sysadmin does when their current /etc/hosts setting breaks some program is to change it to somerthing else, wait for the next thing to break, and ignore the problem otherwise. So I don&#8217;t think this is necessarily really a new problem, and I don&#8217;t know that there is actually a fix that fixes all the problems, and I understand why we don&#8217;t seem to get any feedback evne if it&#8217;s broken. :-/</p><tr id="id_59"><td class="user">Christoph Haas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00381.html">2005/10/09 18:29:46</a><td class="message"><blockquote class="with-author">
<p class="with-author">Joey Hess</p>
<p class="with-author">But it&#8217;s then very hard to see if this breaks anything. After all, the relevant change was made in netcfg in July of 2004. For an entire year, it was in every system installed, and nobody complained, although a few of us noticed it and thought it looked a bit strange.</p>
</blockquote><p>I had this problem since then because I use MySQL very intensively. But I just didn&#8217;t ask here. That doesn&#8217;t mean that I made this up. Sometimes bugs are reported long times after they appeared. The complaint is not about the &#8220;strange looks&#8221; but about interoperation problems.</p><blockquote class="with-author">
<p class="with-author">Joey Hess</p>
<p class="with-author">If I make any changes, I don&#8217;t want to have them pop up and result in another thread like this<sup class="footnote"><a href="#fn129280451918020841359807654891">1</a></sup> in 1.5 years time when we&#8217;re trying to release, or have just released, etch.</p>
</blockquote><p>It is surely difficult to just remove it since newer applications may rely on it. But shouldn&#8217;t we better announce that intended change to debian-devel-announce and ask for feedback if it breaks someone else&#8217;s work?  Similar to library transitions.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Joey Hess</p>
<p class="with-author non-relevant">So far, this thread has not yeilded anything I can trust to that degree.</p>
</blockquote><p class="non-relevant"><span class="caps">IIRC</span> it yielded the fact that localhost.localdomain is has been added to fix applications without being aware that it may break other applications. That&#8217;s a lot more than the first postings saying &#8220;you are inventing things&#8221;, &#8220;it&#8217;s a known bug for MySQL&#8221; or &#8220;use localhost.localdomain in MySQL then&#8221; which all weren&#8217;t satisfying.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Joey Hess</p>
<p class="with-author non-relevant"><sup class="footnote"><a href="#fn050837316084653141359807654898">1</a></sup> Especially not given the quantity of whining, hot air, uninformed comments, stupid comparisons to red hat, etc that have made portions of this thread such a positive joy to read.</p>
</blockquote><p class="non-relevant">Why so rude? I asked for comments on the &#8220;why&#8220;s. And all we had were assumptions since nobody knew for sure. And even we now know how that entry appeared we can&#8217;t figure out why it went there and if it&#8217;s safe to remove it.  I would stop emitting &#8220;hot air&#8221; if it wouldn&#8217;t break other applications. But it does. And this is not my workplace where my boss tells me &#8220;it has always been like that&#8221;. Let&#8217;s change it.</p><tr id="id_60"><td class="user">Peter Samuelson<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00393.html">2005/10/10 07:31:00</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Christoph Haas</p>
<p class="with-author non-relevant"><span class="caps">IIRC</span> it yielded the fact that localhost.localdomain is has been added to fix applications</p>
</blockquote><p class="non-relevant">Not that I&#8217;ve noticed.  Maybe I just missed it, but <strong>what</strong> applications or <strong>what</strong> problems does .localdomain fix?  I don&#8217;t remember hearing so far that it does anything positive at all.</p><p class="non-relevant">If anybody knows anything at all about a problem .localdomain solves, I would love to hear about it.  Never mind the alleged applications that break, I&#8217;m more interested in whether there are even two sides to this story in the first place.</p><tr id="id_61"><td class="user">Thomas Hood<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00554.html">2005/10/13 14:02:15</a><td class="message"><p>The change from &#8216;localhost&#8217; to &#8216;localhost.localdomain&#8217; was made in svn revision 16759.  The Debian changelog entry added at that time refers to bug report <a href="http://tinyurl.com/2an2ujy">#247734</a>.  Looking at <a href="http://tinyurl.com/2an2ujy">#247734</a> I see that &#8216;localhost.localdomain&#8217; appeared without anyone either supporting its inclusion or objecting to it.  This wasn&#8217;t what the conversation was about.</p><p class="non-relevant">I see no reason not to revert the change.  If the presence of &#8216;localhost.localdomain&#8217; causes trouble and if standard practice is to have &#8216;localhost&#8217; only then I think that that is reason enough to revert.</p><p class="non-relevant">However, I think that applications should work properly whether /etc/hosts contains</p><pre class="non-relevant">127.0.0.1 localhost.localdomain localhost
</pre><p class="non-relevant">or</p><pre class="non-relevant">127.0.0.1 localhost
</pre><p class="non-relevant">especially considering the fact that the sarge installer writes /etc/hosts with the former.</p><tr id="id_62"><td class="user">Jeff Stevens<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00559.html">2005/10/13 19:35:11</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Thomas Hood</p>
<p class="with-author non-relevant">The change from &#8216;localhost&#8217; to &#8216;localhost.localdomain&#8217; was made in svn revision 16759.  The Debian changelog entry added at that time refers to bug report <a href="http://tinyurl.com/2an2ujy">#247734</a>.  Looking at <a href="http://tinyurl.com/2an2ujy">#247734</a> I see that &#8216;localhost.localdomain&#8217; appeared without anyone either supporting its inclusion or objecting to it.  This wasn&#8217;t what the conversation was about.</p>
<p class="with-author non-relevant">I see no reason not to revert the change.  If the presence of &#8216;localhost.localdomain&#8217; causes trouble and if standard practice is to have &#8216;localhost&#8217; only then I think that that is reason enough to revert.</p>
<p class="with-author non-relevant">However, I think that applications should work properly whether /etc/hosts contains</p>
<p class="with-author non-relevant">127.0.0.1 localhost.localdomain localhost</p>
<p class="with-author non-relevant">or</p>
<p class="with-author non-relevant">127.0.0.1 localhost</p>
<p class="with-author non-relevant">especially considering the fact that the sarge installer writes /etc/hosts with the former.</p>
</blockquote><p class="non-relevant">Others on this list have pointed out that some applications expect 127.0.0.1 to resolve to localhost.  When the resolver uses /etc/hosts, it returns the first host in the list and the others are considered aliases.  In the first example above, localhost.localdomain would be returned when resolving 127.0.0.1; this is because it is listed before localhost.  If /etc/hosts were changed to:</p><pre class="non-relevant">127.0.0.1 localhost localhost.localdomain
</pre><p class="non-relevant">Resolution of 127.0.0.1 would properly return localhost.</p><p class="relevant">I&#8217;ve been unable to find any specific reference to a required structure of a hosts file nor any specific requirement that a resolver should resolve 127.0.0.1 to localhost.  However, consider the following two points:</p><ol class="non-relevant">
<li><span class="relevant">When configuring <span class="caps">DNS</span>, 127.0.0.1 must resolve to localhost and vice versa [1].  Configuring an /etc/hosts file that resolves 127.0.0.1 to localhost.localdomain is inconsistent.  On the same host, resolving 127.0.0.1 by gethostbyname() and running nslookup will return two different answers (provided nsswitch.conf is configured with &#8220;files dns&#8221;).  [1] <span class="caps">RFC</span> 1912 &#8211; http://www.ietf.org/rfc/rfc1912.txt</span></li>
<li>Virtually all systems with a hosts file read something like this:</li>
</ol><pre class="oli non-relevant">127.0.0.1 localhost &#60;alias&#62; &#60;another alias&#62; &#60;...&#62;
</pre><p class="oli non-relevant">There is a long historical precedent for listing localhost first, followed by other aliases.  This results in the resolver properly returning localhost when resolving 127.0.0.1.</p><p class="non-relevant">In summary: (1) It&#8217;s reasonable to expect <span class="caps">DNS</span> and file based resolution to function the same in regard to 127.0.0.1/localhost (proper <span class="caps">DNS</span> resolution of 127.0.0.1 is documented in <span class="caps">RFC</span> 1912).  (2) There is a long historical precedent for localhost preceding all aliases of 127.0.0.1 in a hosts file.</p><tr id="id_63"><td class="user">Peter Samuelson<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00569.html">2005/10/14 08:25:53</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Jeff Stevens</p>
<p class="with-author non-relevant">If /etc/hosts were changed to:</p>
<p class="with-author non-relevant">127.0.0.1 localhost localhost.localdomain</p>
<p class="with-author non-relevant">Resolution of 127.0.0.1 would properly return localhost.</p>
</blockquote><p class="non-relevant">Yeah, but that&#8217;s all beside the point.  There is no point in swapping the order of the two names unless there be any point in having &#8220;localhost.localdomain&#8221; in there at all.</p><p class="non-relevant">So far, I haven&#8217;t heard any reason.</p><p class="non-relevant">In other words, rather than say &#8220;here is how we could change the hosts file so that localhost.localdomain does not cause buggy apps to break&#8221;, we are (or should be) asking &#8220;why should localhost.localdomain be in there at all?&#8221;</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Jeff Stevens</p>
<p class="with-author non-relevant">2. Virtually all systems with a hosts file read something like this:</p>
<p class="with-author non-relevant">127.0.0.1 localhost <alias> <another alias> <...></p>
<p class="with-author non-relevant">There is a long historical precedent for listing localhost first,</p>
</blockquote><p class="non-relevant">Well, that&#8217;s not quite true.  <span class="neutral">As someone else pointed out earlier, <span class="caps">AIX</span> lists &#8220;loopback localhost&#8221;.  (He said <span class="caps">AIX</span> 5.1 or 5.2, but I first noticed it in 4.1.)  I always thought it was kind of strange and nonstandard &#8230; but on the other hand, most everything in <span class="caps">AIX</span> is kind of strange and nonstandard.</span></p><tr id="id_64"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00762.html">2005/10/20 14:30:12</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Peter Samuelson</p>
<p class="with-author non-relevant">Well, that&#8217;s not quite true.  As someone else pointed out earlier, <span class="caps">AIX</span> lists &#8220;loopback localhost&#8221;.</p>
</blockquote><p class="non-relevant">On a fresh OpenBSD 3.7 install:</p><pre class="non-relevant">::1 localhost.home localhost
127.0.0.1 localhost.home localhost
</pre><p class="non-relevant">(&#8220;home&#8221; is the domain used on my vmware intranet). So &#8220;localhost&#8221; is not the first alias here either.</p><tr id="id_65"><td class="user">Miles Bader<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00780.html">2005/10/21 01:18:19</a><td class="message"><blockquote class="with-author">
<p class="with-author">Gabor Gombas</p>
<p class="with-author">On a fresh OpenBSD 3.7 install:</p>
<p class="with-author">::1 localhost.home localhost<br />
127.0.0.1 localhost.home localhost</p>
</blockquote><p>Heh, I&#8217;m just surprised it&#8217;s not:</p><pre>127.0.0.1 OpenLocalHOST localhost
</pre><tr id="id_66"><td class="user">Thomas Hood<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00572.html">2005/10/14 08:47:51</a><td class="message"><p class="relevant">OK, I have modified netcfg so that it writes</p><pre class="relevant">127.0.0.1   localhost
</pre><p class="relevant">to /etc/hosts.</p><p class="relevant">From now on let&#8217;s consider at least the following two phenomena to be bugs:</p><ul class="relevant">
<li>The application expects to be able to resolve &#8216;localhost.localdomain&#8217; to an IP address.</li>
<li>The application breaks if &#8216;localhost.localdomain&#8217; is included on the 127.0.0.1 line in /etc/hosts.</li>
</ul><tr id="id_67"><td class="user">Wesley J. Landaker<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00579.html">2005/10/14 14:08:23</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Thomas Hood</p>
<p class="with-author non-relevant">OK, I have modified netcfg so that it writes</p>
<p class="with-author non-relevant">127.0.0.1 localhost</p>
<p class="with-author non-relevant">to /etc/hosts.</p>
</blockquote><p class="non-relevant">Thank you! Yay for purging ugly non-standardness! =)</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Thomas Hood</p>
<p class="with-author non-relevant">From now on let&#8217;s consider at least the following two phenomena to be bugs:</p>
<p class="with-author non-relevant">* The application expects to be able to resolve &#8216;localhost.localdomain&#8217; to an IP address.<br />
* The application breaks if &#8216;localhost.localdomain&#8217; is included on the 127.0.0.1 line in /etc/hosts.</p>
</blockquote><p class="non-relevant">Yes, I totally agree here. =)</p><tr id="id_68"><td class="user">Jeff Stevens<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00587.html">2005/10/14 17:14:28</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Thomas Hood</p>
<p class="with-author non-relevant">OK, I have modified netcfg so that it writes</p>
<p class="with-author non-relevant">127.0.0.1 localhost</p>
<p class="with-author non-relevant">to /etc/hosts.</p>
<p class="with-author non-relevant">From now on let&#8217;s consider at least the following two phenomena to be bugs:</p>
<p class="with-author non-relevant">* The application expects to be able to resolve &#8216;localhost.localdomain&#8217; to an IP address.<br />
* The application breaks if &#8216;localhost.localdomain&#8217; is included on the 127.0.0.1 line in /etc/hosts.</p>
</blockquote><p class="non-relevant">Fantastic!  Might I add that it is <strong>not</strong> a bug for an application to expect resolution of 127.0.0.1 to return localhost?  That is, localhost shall precede any other aliases in /etc/hosts.</p><p class="non-relevant">Again, thank you.  Attention to detail is quite important; in this case detail is the location and/or existence of a mere 21 bytes.</p><tr id="id_69"><td class="user">Christoph Haas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00588.html">2005/10/14 17:34:25</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Thomas Hood</p>
<p class="with-author non-relevant">OK, I have modified netcfg so that it writes</p>
<p class="with-author non-relevant">127.0.0.1 localhost</p>
<p class="with-author non-relevant">to /etc/hosts.</p>
</blockquote><p class="non-relevant">Thank you very much. My fellow sysadmins will appreciate that.  And of course I&#8217;m very glad that after a lot of global warming the thread finally got somewhere. :)</p><tr id="id_70"><td class="user">Stig Sandbeck Mathisen<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00589.html">2005/10/14 17:18:21</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Thomas Hood</p>
<p class="with-author non-relevant">OK, I have modified netcfg so that it writes</p>
<p class="with-author non-relevant">127.0.0.1    localhost</p>
<p class="with-author non-relevant">to /etc/hosts.</p>
</blockquote><p class="non-relevant">Excellent.  Thank you.  :)</p><tr id="id_71"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00758.html">2005/10/20 14:09:13</a><td class="message"><blockquote class="with-author">
<p class="with-author">Jeff Stevens</p>
<p class="with-author">1. When configuring <span class="caps">DNS</span>, 127.0.0.1 must resolve to localhost and vice versa [1].</p>
</blockquote><p>No, the <span class="caps">RFC</span> does not say &#8220;must&#8221;, it only says &#8220;should&#8221; (and it is not even a &#8220;SHOULD&#8221;).</p><p class="non-relevant">An regardless if localhost.localdomain is removed from /etc/hosts or not, finding & fixing applications that choke on it is a good thing.</p><tr id="id_72"><td class="user">Bernd Eckenfels<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00252.html">2005/10/06 18:36:13</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant">I can not remember precisely. I think that at that time I was testing the debian-installer and I saw it was taken a long while to boot. I saw that my system had no <span class="caps">FQDN</span> (hostname -f). When you add .localdomain, the <span class="caps">FQDN</span> is complete and it helps to solve timeout in several application.</p>
</blockquote><p class="non-relevant">Nope, hostname is not responsible for this.</p><p class="non-relevant">Yes you need to configure the <span class="caps">FQDN</span> in hosts, but not with the 127.0.0.1 entry. And hostname should also never return this stupid dummy <span class="caps">FQDN</span> (however it does not avoid to do so).</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant">Anyway I do not understand why this issue is a problem since we simply add an alias to localhost.</p>
</blockquote><p class="non-relevant">The problem is that it is the <em>first</em> alias.</p><tr id="id_73"><td class="user">Stig Sandbeck Mathisen<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00284.html">2005/10/07 05:21:12</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant">Anyway I do not understand why this issue is a problem since we simply add an alias to localhost. Nobody say that we will remove localhost and exchange it by localhost.localdomain.</p>
</blockquote><p class="non-relevant">If what you wanted to do was to add an alias, you should have read the documentation on how to add an alias without changing the canonical hostname for 127.0.0.1.  This documentation is available in hosts(5).</p><blockquote class="non-relevant">
<p class="non-relevant">This manual page describes the format of the /etc/hosts file.  This file is a simple text file that associates IP addresses with hostnames, one line per IP address. For each host a single line should be present with the following information:</p>
<p class="non-relevant">IP_address canonical_hostname aliases</p>
</blockquote><p>Changing the canonical hostname changes the output of everything that resolves IP address, including &#8220;lsof&#8221; and &#8220;netstat&#8221;.</p><p>Any script or program dependent on this output need to be checked and possibly changed if it is to behave as it should.  This includes local scripts created by our users.</p><p class="relevant">It should also be consistent with bind9, and I do <em>not</em> think that changing bind is the correct way to do things.</p><pre class="relevant">iostat:~# getent hosts 127.0.0.1
127.0.0.1       localhost.localdomain localhost iostat
iostat:~# dig -x 127.0.0.1 @localhost
; &#60;&#60;&#62;&#62; DiG 9.2.4 &#60;&#60;&#62;&#62; -x 127.0.0.1 @localhost
;; global options:  printcmd
;; Got answer:
;; -&#62;&#62;HEADER&#60;&#60;- opcode: QUERY, status: NOERROR, id: 11671
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 1

;; QUESTION SECTION:
;1.0.0.127.in-addr.arpa.                IN      PTR

;; ANSWER SECTION:
1.0.0.127.in-addr.arpa. 604800  IN      PTR     localhost.

;; AUTHORITY SECTION:
127.in-addr.arpa.       604800  IN      NS      localhost.

;; ADDITIONAL SECTION:
localhost.              604800  IN      A       127.0.0.1

;; Query time: 3 msec
;; SERVER: 127.0.0.1#53(localhost)
;; WHEN: Fri Oct  7 07:19:19 2005
;; MSG SIZE  rcvd: 93
</pre><tr id="id_74"><td class="user">Christoph Haas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00318.html">2005/10/07 14:26:30</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Pierre Machard</p>
<p class="with-author non-relevant">I can not remember precisely. I think that at that time I was testing the debian-installer and I saw it was taken a long while to boot. I saw that my system had no <span class="caps">FQDN</span> (hostname -f). When you add .localdomain, the <span class="caps">FQDN</span> is complete and it helps to solve timeout in several application.</p>
<p class="with-author non-relevant">Anyway I do not understand why this issue is a problem since we simply add an alias to localhost. Nobody say  that we will remove localhost and exchange it by localhost.localdomain.</p>
</blockquote><p class="non-relevant">The problem is probably that the &#8220;localhost.localdomain&#8221; stands before &#8220;localhost&#8221; in that line. So if you &#8220;reverse resolve&#8221; 127.0.0.1 you end up with &#8220;localhost.localdomain&#8221; which some applications don&#8217;t understand.</p><tr id="id_75"><td class="user">Jeff Stevens<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00387.html">2005/10/08 20:07:43</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Christoph Haas</p>
<p class="with-author non-relevant">The problem is probably that the &#8220;localhost.localdomain&#8221; stands before &#8220;localhost&#8221; in that line. So if you &#8220;reverse resolve&#8221; 127.0.0.1 you end up with &#8220;localhost.localdomain&#8221; which some applications don&#8217;t understand.</p>
</blockquote><p class="non-relevant">Christopher hits the nail on the head.  There are two separate issues:</p><ol class="non-relevant">
<li>Is there a reason to have localhost.localdomain</li>
<li>If there is localhost.localdomain should <strong>not</strong> precede localhost!</li>
</ol><p class="non-relevant">I&#8217;m not going to comment on the former but the latter is a <strong><span class="caps">BIG</span></strong> deal.  The current Debian /etc/hosts file is flat out wrong.  When a call to gethostbyname(3) or gethostbyaddr(3) and an IPV4 address of 127.0.0.1 is supplied, it should return &#8220;localhost&#8221;.  Provided resolv.conf is configured to use files and then dns, gethostbyname/gethostbyaddr is going to query /etc/hosts.  In /etc/hosts multiple hostnames can be assigned to a single address, but when resolving an address to a hostname, the <strong>first</strong> hostname in the list is returned by gethostbyname/gethostbyaddr.</p><p>Every sane implementation of IP returns &#8220;localhost&#8221; when querying 127.0.0.1.  It doesn&#8217;t matter if the implementation uses /etc/hosts, /etc/inet/hosts, /boot/beos/etc/hosts, or (*gulp*) c:\winnt\system32\drivers\etc\hosts.</p><p class="non-relevant">Of course, other systems ship with a default hosts file containing something in addition to &#8220;localhost&#8221; that resolves to 127.0.0.1.  The issue with Debian is that &#8220;localhost.localdomain&#8221; comes <strong>before</strong> &#8220;localhost&#8221;.  A call to gethostbyname() to resolve localhost returns a struct referring to 127.0.0.1.  A call to gethostbyname() to resolve 127.0.01 returns a struct referring to localhost.localdomain.  This is <strong>wrong</strong>.</p><p class="non-relevant">This has been mentioned before, but I&#8217;ll say it again.  This is solely because the Debian /etc/hosts reads:</p><pre class="non-relevant">127.0.0.1       localhost.localdomain localhost
</pre><p class="non-relevant">&#8220;localhost.localdomain&#8221; and &#8220;localhost&#8221; must be swapped.  The first entry in the list of hosts <strong>must</strong> be &#8220;localhost&#8221;.</p><p class="non-relevant">Just as a sanity check, Solaris ships with:</p><pre class="non-relevant">127.0.0.1   localhost loghost
</pre><p class="non-relevant">FreeBSD ships with:</p><pre class="non-relevant">127.0.0.1       localhost localhost.my.domain myname.my.domain
</pre><p class="non-relevant">I don&#8217;t have access to <span class="caps">AIX</span>, <span class="caps">HPUX</span> or other major Unices, but I bet in the hosts file, 127.0.0.1 is immediately followed by localhost &#8212; and other aliases follow localhost.  &#8220;localhost&#8221; <strong>must</strong> be first.</p><tr id="id_76"><td class="user">Russ Allbery<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00344.html">2005/10/08 20:30:26</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Jeff Stevens</p>
<p class="with-author non-relevant">I don&#8217;t have access to <span class="caps">AIX</span>, <span class="caps">HPUX</span> or other major Unices, but I bet in the hosts file, 127.0.0.1 is immediately followed by localhost &#8212; and other aliases follow localhost.  &#8220;localhost&#8221; <strong>must</strong> be first.</p>
</blockquote><pre class="non-relevant">AIX 5.2:      127.0.0.1 loopback localhost
HP-UX 11.00:  127.0.0.1 localhost loopback
IRIX 6.5:     127.0.0.1 localhost
Tru64 4.0G:   127.0.0.1 localhost
</pre><tr id="id_77"><td class="user">Frans Pop<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00347.html">2005/10/08 21:04:09</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Jeff Stevens</p>
<p class="with-author non-relevant">&#8220;localhost.localdomain&#8221; and &#8220;localhost&#8221; must be swapped.  The first entry in the list of hosts <strong>must</strong> be &#8220;localhost&#8221;.</p>
</blockquote><p class="non-relevant">You make quite a lot of noise it this mail, but I fail to find any real arguments. (Unless you consider saying &#8220;this should be so&#8221; or &#8220;this is wrong&#8221; an argument.)</p><p class="non-relevant">You give nice explanations how things work, but fail to say anywhere why having localhost.localdomain first is so wrong.  What breaks? What standards (with reference please) are not honored?  What alternative solutions do you propose for the problems that led up to it being included?</p><tr id="id_78"><td class="user">Marco d&#39;Itri<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00353.html">2005/10/08 22:58:23</a><td class="message"><blockquote class="with-author">
<p class="with-author">Frans Pop</p>
<p class="with-author">You give nice explanations how things work, but fail to say anywhere why having localhost.localdomain first is so wrong.  What breaks? What standards (with reference please) are not honored?</p>
</blockquote><p class="relevant">An obvious problem is that gethostbyaddr and <span class="caps">DNS</span> queries will now return a different answer.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Frans Pop</p>
<p class="with-author non-relevant">What alternative solutions do you propose for the problems that led up to it being included?</p>
</blockquote><p class="non-relevant">It has already been explained that a better solution with no side effects would be to add an alias like 127.1.0.1</p><tr id="id_79"><td class="user">Steve Langasek<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00365.html">2005/10/09 04:20:04</a><td class="message"><blockquote class="with-author">
<p class="with-author">Frans Pop</p>
<p class="with-author">You make quite a lot of noise it this mail, but I fail to find any real arguments. (Unless you consider saying &#8220;this should be so&#8221; or &#8220;this is wrong&#8221; an argument.)</p>
<p class="with-author">You give nice explanations how things work, but fail to say anywhere why having localhost.localdomain first is so wrong.  What breaks? What standards (with reference please) are not honored?</p>
</blockquote><p>Well, even if Jeff didn&#8217;t provide anything helpful in this regard, the thread does show at least two specific packages that break when using localhost.localdomain as the canonical name for 127.0.0.1: mysql, and inn.  Yes, it is appropriate to fix both of these applications to be more robust; however,</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Frans Pop</p>
<p class="with-author non-relevant">What alternative solutions do you propose for the problems that led up to it being included?</p>
</blockquote><p class="non-relevant">I can&#8217;t actually see anything in the bug log to indicate that localhost.localdomain <strong>does</strong> solve any of the issues that were raised.</p><tr id="id_80"><td class="user">Jeff Stevens<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00366.html">2005/10/09 06:10:05</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Frans Pop</p>
<p class="with-author non-relevant">You make quite a lot of noise it this mail, but I fail to find any real arguments. (Unless you consider saying &#8220;this should be so&#8221; or &#8220;this is wrong&#8221; an argument.)</p>
<p class="with-author non-relevant">You give nice explanations how things work, but fail to say anywhere why having localhost.localdomain first is so wrong.  What breaks? What standards (with reference please) are not honored?  What alternative solutions do you propose for the problems that led up to it being included?</p>
</blockquote><p class="relevant">You are correct that there probably are not any documented standards requiring &#8220;127.0.0.1&#8221; to resolve to &#8220;localhost&#8221; except when <span class="caps">DNS</span> is used.  That is, if <span class="caps">DNS</span> is queried to resolve &#8220;127.0.0.1&#8221; it is expected to resolve to &#8220;localhost&#8221; &#8212; nothing else.  I don&#8217;t believe such a written standard exists for resolution through /etc/hosts.</p><p class="non-relevant">I&#8217;m simply trying to illustrate that there are years of precedent.  It has been safe to assume that a resolver will resolve &#8220;127.0.0.1&#8221; to &#8220;localhost&#8221; &#8212; even if resolution is completed by using a hosts file.</p><p class="non-relevant">Taking into consideration:</p><ul class="non-relevant">
<li><span class="caps">DNS</span> is expected to resolve &#8220;127.0.0.1&#8221; to &#8220;localhost&#8221;</li>
<li>Applications expect resolution of &#8220;127.0.0.1&#8221; to &#8220;localhost&#8221;</li>
<li>Consistent cross vendor resolution of &#8220;127.0.0.1&#8221; to &#8220;localhost&#8221;</li>
</ul><p class="non-relevant">There may not be a written standard but a de facto standard certainly exists.</p><tr id="id_81"><td class="user">Stig Sandbeck Mathisen<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00283.html">2005/10/07 05:10:07</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant">Ok, after a quick googling I found that this bug has already been reported for MySQL: http://bugs.mysql.com/11822 and is fixed in MySQL 5.0.11. So if it bothers you, you should upgrade.</p>
</blockquote><p class="non-relevant">Changing the canonical name of localhost is an arbitrary change that breaks more than MySQL. It also violates the principle of least astonishment.</p><p class="non-relevant">&#8220;We&#8217;ve changed something, we&#8217;re not sure why, but it breaks MySQL.  If it bothers you, you should upgrade MySQL&#8221;</p><p class="non-relevant">Nah, I don&#8217;t think that is what we want to tell our users.</p><tr id="id_82"><td class="user">Gabor Gombas<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00311.html">2005/10/07 12:20:35</a><td class="message"><blockquote class="with-author">
<p class="with-author">Stig Sandbeck Mathisen</p>
<p class="with-author">Changing the canonical name of localhost is an arbitrary change that breaks more than MySQL. It also violates the principle of least astonishment.</p>
</blockquote><p>Then fix those other broken things as well. If you want localhost-style authentication, you <em>should</em> do the comparison on the IP address rather than the resolved name for several reasons:</p><ul>
<li>The IP address range for the loopback interface is standardized (127.0.0.0/8). The value returned by the reverse lookup is not.</li>
</ul><ul>
<li>Doing the reverse lookup may introduce an attack vector because it relies on the whole <span class="caps">NSS</span> being configured right. Avoiding the reverse lookup avoids this attack vector.</li>
</ul><ul>
<li>Doing the reverse lookup is just unneccessary, avoiding it saves <span class="caps">CPU</span> cycles (this may be important if you want to serve lots of connection attempts)</li>
</ul><tr id="id_83"><td class="user">Stig Sandbeck Mathisen<br><a class="timestamp" href="http://lists.debian.org/debian-devel/2005/10/msg00354.html">2005/10/08 22:43:58</a><td class="message"><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant">Then fix those other broken things as well.</p>
</blockquote><p class="non-relevant">Contrary to popular belief among our users, system administrators does not have access to every server on the internet. Therefore, I can not help you solve this issue in this way.</p><p class="non-relevant">Instead, I propose we return the content of the Debian /etc/hosts file to the way it was before the change.</p><blockquote class="with-author non-relevant">
<p class="with-author non-relevant">Gabor Gombas</p>
<p class="with-author non-relevant">If you want localhost-style authentication, you <em>should</em> do the comparison on the IP address rather than the resolved name for several reasons:</p>
<p class="with-author non-relevant">[snip good reasons]</p>
</blockquote><p class="non-relevant">I don&#8217;t trust client address/name resolving for any authentication of clients. I resent the implication that I do.</p></table></body></html>